## Implementation Spec â€” Templates & Composer

Implementation Order: 2

### Overview

Expose example-based templates and a custom modular composer via dropdowns for LLM, ASR/Transcriber, TTS (and VAD as needed), plus STS selection.

### Goals

- One-click template provisioning.
- Flexible custom composition with compatibility checks.

### Functional Requirements

1. List templates derived from `src/main/infra/examples`.
2. Create deployment from a template, pre-filling providers and defaults.
3. Custom composer with dropdowns for each stage; prevent invalid mixes.
4. Persist selection to `deployment.json`.

### UI/UX

- Templates grid + Create button.
- Composer form with provider dropdowns and inline hints.

### Data & Persistence

- Stored inside per-deployment `deployment.json`.

### IPC/Backend

- IPC to create deployment folders and save JSON.

### Validation

- Required providers present per stack type; warn on missing keys.

### Out of Scope

- Drag-and-drop graph editor (MVP).

### Open Questions

- How to represent VAD explicitly vs ASR defaults.

### Notes

- Implementation planning will use the Generate Task List rule in `rules/`.

### Data Model (deployment.json core)

```json
{
  "id": "uuid",
  "name": "",
  "slug": "",
  "type": "modular" | "sts",
  "providers": {
    "llm": "openai" | "anthropic" | "gemini",
    "asr": "deepgram" | "google" | "vosk",
    "tts": "elevenlabs" | "google",
    "sts": "openai-realtime" | "ultravox"
  },
  "options": { "llm": {}, "asr": {}, "tts": {}, "sts": {} }
}
```

### Template Registry (derived from examples)

- `openai`, `anthropic`, `google`/`gemini`, `deepgram`, `vosk`, `elevenlabs`, `openai-realtime`, `ultravox`, `n8n`.
- Each template maps to a minimal set of services and default options.

### IPC API

- `deployments:create` (from template or custom selection)
- `deployments:list` (reads `deployments/*/deployment.json`)
- `deployments:update` (rename, change providers/options)
- `deployments:duplicate`, `deployments:delete`

### Renderer Components

- `TemplatesGrid` (cards sourced from examples)
- `ComposerForm` (dropdowns for LLM/ASR/TTS or STS)

### Acceptance Criteria

- Creating from template produces a valid `deployment.json` with id/slug.
- Custom composer prevents incompatible selections and missing required roles.
- Duplicate/rename operations update both JSON and folder names.

### Tasks Outline

- Define providers/options enums and validation logic.
- Implement template-to-deployment mapping.
- Build composer UI with dynamic validation and helpful hints.
- Implement deployment CRUD IPC and filesystem operations.
